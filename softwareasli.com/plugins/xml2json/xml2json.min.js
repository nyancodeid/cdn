function xml2json(e,n,t){t=void 0===t||!!t;var i=!!n.length,r={toObj:function(e){var n={};if(1==e.nodeType){if(t&&e.attributes.length)for(var i=0;i<e.attributes.length;i++)n["@"+e.attributes[i].nodeName]=(e.attributes[i].nodeValue||"").toString();if(e.firstChild){for(var o=0,l=0,a=!1,d=e.firstChild;d;d=d.nextSibling)1==d.nodeType?a=!0:3==d.nodeType&&d.nodeValue.match(/[^ \f\n\r\t\v]/)?o++:4==d.nodeType&&l++;if(a)if(o<2&&l<2){r.removeWhite(e);for(d=e.firstChild;d;d=d.nextSibling)3==d.nodeType?n["#text"]=r.escape(d.nodeValue):4==d.nodeType?n["#cdata"]=r.escape(d.nodeValue):n[d.nodeName]?n[d.nodeName]instanceof Array?n[d.nodeName][n[d.nodeName].length]=r.toObj(d):n[d.nodeName]=[n[d.nodeName],r.toObj(d)]:n[d.nodeName]=r.toObj(d)}else e.attributes.length?n["#text"]=r.escape(r.innerXml(e)):n=r.escape(r.innerXml(e));else if(o)t&&e.attributes.length?n["#text"]=r.escape(r.innerXml(e)):n=r.escape(r.innerXml(e));else if(l)if(l>1)n=r.escape(r.innerXml(e));else for(d=e.firstChild;d;d=d.nextSibling)n["#cdata"]=r.escape(d.nodeValue)}e.attributes.length||e.firstChild||(n=null)}else 9==e.nodeType?n=r.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return n},toJson:function(e,n,t){var o=n?'"'+n+'"':"";if(e instanceof Array){for(var l=0,a=e.length;l<a;l++)e[l]=r.toJson(e[l],"",t+"\t");o+=(n?i?": [":":[":"[")+(e.length>1?"\n"+t+"\t"+e.join(",\n"+t+"\t")+"\n"+t:e.join(""))+"]"}else if(null==e)o+=(n&&":")+"null";else if("object"==typeof e){var d=[];for(var s in e)d[d.length]=r.toJson(e[s],s,t+"\t");o+=(n?i?": {":":{":"{")+(d.length>=1?"\n"+t+"\t"+d.join(",\n"+t+"\t")+"\n"+t:d.join(""))+"}"}else o+="string"==typeof e?(n&&(i?": ":":"))+'"'+e.toString()+'"':(n&&(i?": ":":"))+e.toString();return o},innerXml:function(e){var n="";if("innerHTML"in e)n=e.innerHTML;else for(var t=function(e){var n="";if(1==e.nodeType){n+="<"+e.nodeName;for(var i=0;i<e.attributes.length;i++)n+=" "+e.attributes[i].nodeName+'="'+(e.attributes[i].nodeValue||"").toString()+'"';if(e.firstChild){n+=">";for(var r=e.firstChild;r;r=r.nextSibling)n+=t(r);n+="</"+e.nodeName+">"}else n+="/>"}else 3==e.nodeType?n+=e.nodeValue:4==e.nodeType&&(n+="<![CDATA["+e.nodeValue+"]]>");return n},i=e.firstChild;i;i=i.nextSibling)n+=t(i);return n},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var n=e.firstChild;n;)if(3==n.nodeType)if(n.nodeValue.match(/[^ \f\n\r\t\v]/))n=n.nextSibling;else{var t=n.nextSibling;e.removeChild(n),n=t}else 1==n.nodeType?(r.removeWhite(n),n=n.nextSibling):n=n.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);var o=r.toJson(r.toObj(r.removeWhite(e)),e.nodeName,"\t");return"{"+(i?"\n":"")+n+(n?o.replace(/\t/g,n):o.replace(/\t|\n/g,""))+(i?"\n":"")+"}"}